{"ast":null,"code":"import user from \"@/logic/user\";\nimport jwt_decode from \"jwt-decode\";\nexport default {\n  namespace: true,\n\n  state() {\n    return {\n      user: null,\n      token: null\n    };\n  },\n\n  mutations: {\n    addToken(state, data) {\n      state.token = data;\n    },\n\n    removeToken(state) {\n      state.token = null;\n    },\n\n    setUser(state, data) {\n      state.user = data;\n    }\n\n  },\n  actions: {\n    async login(context, creds) {\n      const res = await user.login(creds);\n      if (!res) return false;\n\n      if (res.status === 200 && res.data.token) {\n        context.commit('addToken', res.data.token);\n        context.commit('setUser', {\n          'username': res.data.username,\n          'name': res.data.name,\n          'email': res.data.email\n        });\n        window.localStorage.setItem('authToken', `bearer ${context.state.token}`);\n        return true;\n      }\n\n      return false;\n    },\n\n    checkLocalStorage(context) {\n      var token = window.localStorage.getItem('authToken');\n\n      if (token) {\n        context.commit('addToken', token);\n        return true;\n      }\n\n      return false;\n    },\n\n    autoLogin({\n      state,\n      commit\n    }) {\n      const data = jwt_decode(state.token);\n      commit('setUser', data);\n    },\n\n    deleteToken({\n      commit\n    }) {\n      commit('deleteToken');\n    }\n\n  }\n};","map":{"version":3,"names":["user","jwt_decode","namespace","state","token","mutations","addToken","data","removeToken","setUser","actions","login","context","creds","res","status","commit","username","name","email","window","localStorage","setItem","checkLocalStorage","getItem","autoLogin","deleteToken"],"sources":["/Users/ahmed/Documents/projects/vulnerable_node_app/frontend/src/modules/user.js"],"sourcesContent":["import user from \"@/logic/user\"\nimport jwt_decode from \"jwt-decode\";\n\nexport default {\n    namespace: true,\n    state() {\n        return {\n            user: null,\n            token: null\n        }\n    },\n    mutations: {\n        addToken(state, data) { \n            state.token = data \n        },\n        removeToken(state) {\n            state.token = null\n        },\n        setUser(state, data) { \n            state.user = data \n        }\n    },\n    actions: {\n        async login(context, creds) {\n            const res = await user.login(creds)\n            if(!res) return false\n\n            if((res.status === 200) && (res.data.token)) {\n                context.commit('addToken', res.data.token)\n                context.commit('setUser', {\n                    'username': res.data.username,\n                    'name': res.data.name,\n                    'email': res.data.email\n                })\n\n                window.localStorage.setItem('authToken', `bearer ${context.state.token}`)\n                return true\n            }\n\n            return false\n        },\n        checkLocalStorage(context) {\n            var token = window.localStorage.getItem('authToken')\n            \n            if(token) {\n                context.commit('addToken', token)\n                return true\n            }\n\n            return false\n        },\n        autoLogin({ state, commit }) {\n            const data = jwt_decode(state.token)\n            commit('setUser', data)\n        },\n        deleteToken({ commit }) {\n            commit('deleteToken')\n        }\n    }\n}"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,cAAjB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AAEA,eAAe;EACXC,SAAS,EAAE,IADA;;EAEXC,KAAK,GAAG;IACJ,OAAO;MACHH,IAAI,EAAE,IADH;MAEHI,KAAK,EAAE;IAFJ,CAAP;EAIH,CAPU;;EAQXC,SAAS,EAAE;IACPC,QAAQ,CAACH,KAAD,EAAQI,IAAR,EAAc;MAClBJ,KAAK,CAACC,KAAN,GAAcG,IAAd;IACH,CAHM;;IAIPC,WAAW,CAACL,KAAD,EAAQ;MACfA,KAAK,CAACC,KAAN,GAAc,IAAd;IACH,CANM;;IAOPK,OAAO,CAACN,KAAD,EAAQI,IAAR,EAAc;MACjBJ,KAAK,CAACH,IAAN,GAAaO,IAAb;IACH;;EATM,CARA;EAmBXG,OAAO,EAAE;IACL,MAAMC,KAAN,CAAYC,OAAZ,EAAqBC,KAArB,EAA4B;MACxB,MAAMC,GAAG,GAAG,MAAMd,IAAI,CAACW,KAAL,CAAWE,KAAX,CAAlB;MACA,IAAG,CAACC,GAAJ,EAAS,OAAO,KAAP;;MAET,IAAIA,GAAG,CAACC,MAAJ,KAAe,GAAhB,IAAyBD,GAAG,CAACP,IAAJ,CAASH,KAArC,EAA6C;QACzCQ,OAAO,CAACI,MAAR,CAAe,UAAf,EAA2BF,GAAG,CAACP,IAAJ,CAASH,KAApC;QACAQ,OAAO,CAACI,MAAR,CAAe,SAAf,EAA0B;UACtB,YAAYF,GAAG,CAACP,IAAJ,CAASU,QADC;UAEtB,QAAQH,GAAG,CAACP,IAAJ,CAASW,IAFK;UAGtB,SAASJ,GAAG,CAACP,IAAJ,CAASY;QAHI,CAA1B;QAMAC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,EAA0C,UAASV,OAAO,CAACT,KAAR,CAAcC,KAAM,EAAvE;QACA,OAAO,IAAP;MACH;;MAED,OAAO,KAAP;IACH,CAlBI;;IAmBLmB,iBAAiB,CAACX,OAAD,EAAU;MACvB,IAAIR,KAAK,GAAGgB,MAAM,CAACC,YAAP,CAAoBG,OAApB,CAA4B,WAA5B,CAAZ;;MAEA,IAAGpB,KAAH,EAAU;QACNQ,OAAO,CAACI,MAAR,CAAe,UAAf,EAA2BZ,KAA3B;QACA,OAAO,IAAP;MACH;;MAED,OAAO,KAAP;IACH,CA5BI;;IA6BLqB,SAAS,CAAC;MAAEtB,KAAF;MAASa;IAAT,CAAD,EAAoB;MACzB,MAAMT,IAAI,GAAGN,UAAU,CAACE,KAAK,CAACC,KAAP,CAAvB;MACAY,MAAM,CAAC,SAAD,EAAYT,IAAZ,CAAN;IACH,CAhCI;;IAiCLmB,WAAW,CAAC;MAAEV;IAAF,CAAD,EAAa;MACpBA,MAAM,CAAC,aAAD,CAAN;IACH;;EAnCI;AAnBE,CAAf"},"metadata":{},"sourceType":"module"}