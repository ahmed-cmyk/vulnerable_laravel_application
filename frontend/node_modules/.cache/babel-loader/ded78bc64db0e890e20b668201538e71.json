{"ast":null,"code":"import user from \"@/logic/user\";\nexport default {\n  namespace: true,\n\n  state() {\n    return {\n      user: null,\n      token: null\n    };\n  },\n\n  mutations: {\n    addToken(state, data) {\n      state.token = data;\n    },\n\n    setUser(state, data) {\n      state.user = data;\n    }\n\n  },\n  actions: {\n    async login(context, creds) {\n      const res = await user.login(creds);\n      if (!res) return false;\n\n      if (res.status === 200 && res.data.token) {\n        context.commit('addToken', res.data.token);\n        context.commit('setUser', {\n          'username': res.data.username,\n          'name': res.data.name,\n          'email': res.data.email\n        });\n        window.localStorage.setItem('authToken', `bearer ${context.state.token}`);\n        return true;\n      }\n\n      return false;\n    },\n\n    checkLocalStorage(context) {\n      var token = window.localStorage.getItem('authToken');\n\n      if (token) {\n        context.commit('addToken', token);\n        return true;\n      }\n\n      return false;\n    }\n\n  }\n};","map":{"version":3,"names":["user","namespace","state","token","mutations","addToken","data","setUser","actions","login","context","creds","res","status","commit","username","name","email","window","localStorage","setItem","checkLocalStorage","getItem"],"sources":["/Users/ahmed/Documents/projects/vulnerable_node_app/frontend/src/modules/user.js"],"sourcesContent":["import user from \"@/logic/user\"\n\nexport default {\n    namespace: true,\n    state() {\n        return {\n            user: null,\n            token: null\n        }\n    },\n    mutations: {\n        addToken(state, data) { \n            state.token = data \n        },\n        setUser(state, data) { \n            state.user = data \n        }\n    },\n    actions: {\n        async login(context, creds) {\n            const res = await user.login(creds)\n            if(!res) return false\n\n            if((res.status === 200) && (res.data.token)) {\n                context.commit('addToken', res.data.token)\n                context.commit('setUser', {\n                    'username': res.data.username,\n                    'name': res.data.name,\n                    'email': res.data.email\n                })\n\n                window.localStorage.setItem('authToken', `bearer ${context.state.token}`)\n                return true\n            }\n\n            return false\n        },\n        checkLocalStorage(context) {\n            var token = window.localStorage.getItem('authToken')\n            \n            if(token) {\n                context.commit('addToken', token)\n                return true\n            }\n\n            return false\n        }\n    }\n}"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,cAAjB;AAEA,eAAe;EACXC,SAAS,EAAE,IADA;;EAEXC,KAAK,GAAG;IACJ,OAAO;MACHF,IAAI,EAAE,IADH;MAEHG,KAAK,EAAE;IAFJ,CAAP;EAIH,CAPU;;EAQXC,SAAS,EAAE;IACPC,QAAQ,CAACH,KAAD,EAAQI,IAAR,EAAc;MAClBJ,KAAK,CAACC,KAAN,GAAcG,IAAd;IACH,CAHM;;IAIPC,OAAO,CAACL,KAAD,EAAQI,IAAR,EAAc;MACjBJ,KAAK,CAACF,IAAN,GAAaM,IAAb;IACH;;EANM,CARA;EAgBXE,OAAO,EAAE;IACL,MAAMC,KAAN,CAAYC,OAAZ,EAAqBC,KAArB,EAA4B;MACxB,MAAMC,GAAG,GAAG,MAAMZ,IAAI,CAACS,KAAL,CAAWE,KAAX,CAAlB;MACA,IAAG,CAACC,GAAJ,EAAS,OAAO,KAAP;;MAET,IAAIA,GAAG,CAACC,MAAJ,KAAe,GAAhB,IAAyBD,GAAG,CAACN,IAAJ,CAASH,KAArC,EAA6C;QACzCO,OAAO,CAACI,MAAR,CAAe,UAAf,EAA2BF,GAAG,CAACN,IAAJ,CAASH,KAApC;QACAO,OAAO,CAACI,MAAR,CAAe,SAAf,EAA0B;UACtB,YAAYF,GAAG,CAACN,IAAJ,CAASS,QADC;UAEtB,QAAQH,GAAG,CAACN,IAAJ,CAASU,IAFK;UAGtB,SAASJ,GAAG,CAACN,IAAJ,CAASW;QAHI,CAA1B;QAMAC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,WAA5B,EAA0C,UAASV,OAAO,CAACR,KAAR,CAAcC,KAAM,EAAvE;QACA,OAAO,IAAP;MACH;;MAED,OAAO,KAAP;IACH,CAlBI;;IAmBLkB,iBAAiB,CAACX,OAAD,EAAU;MACvB,IAAIP,KAAK,GAAGe,MAAM,CAACC,YAAP,CAAoBG,OAApB,CAA4B,WAA5B,CAAZ;;MAEA,IAAGnB,KAAH,EAAU;QACNO,OAAO,CAACI,MAAR,CAAe,UAAf,EAA2BX,KAA3B;QACA,OAAO,IAAP;MACH;;MAED,OAAO,KAAP;IACH;;EA5BI;AAhBE,CAAf"},"metadata":{},"sourceType":"module"}